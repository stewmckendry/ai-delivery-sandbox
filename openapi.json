{
  "openapi": "3.1.0",
  "info": {
    "title": "GovDoc Copilot: PM Edition",
    "version": "1.0.0",
    "description": "Your AI copilot for preparing government project gate submissions. Guides PMs through drafting, reviewing, and finalizing project documentation."
  },
  "servers": [
    {
      "url": "https://robust-adventure-production.up.railway.app",
      "description": "Production server"
    }
  ],
  "security": [
    { "bearerAuth": [] }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {}  
  },
  "paths": { 
    "/tools": {
      "get": {
        "operationId": "listGPTFacingTools",
        "summary": "List available tools for GPT use",
        "tags": ["Tool Discovery"],
        "x-gpt-action": {
          "name": "List Available Tools",
          "instructions": "Call this to get a list of tools that are available for use in this assistant. Only tools marked as GPT-facing will be returned.",
          "summary_keywords": ["list", "tools", "catalog", "discovery"]
        },
        "responses": {
          "200": {
            "description": "Returns an array of tool metadata including tool_id, description, and schema if applicable",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "tool_id": { "type": "string", "example": "getArtifactRequirements" },
                      "description": { "type": "string", "example": "Retrieve required sections and criteria for an artifact" },
                      "schema": { "type": "object" }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/tools/getArtifactRequirements": {
      "post": {
        "operationId": "getArtifactRequirements",
        "summary": "Retrieve the requirements for a specific gate and artifact",
        "tags": ["Input Prep"],
        "x-gpt-action": {
          "name": "Get Artifact Requirements",
          "instructions": "Use this when a user is starting a new artifact. Pass:\n- `project_id`: string\n- `artifact_id`: string\n- `gate_id`: integer\n\nThis returns a structured map of what sections and evaluation criteria need to be filled in, so GPT can guide the user with tailored prompts.",
          "summary_keywords": ["prompt", "generate", "section guidance"]
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "gate_id": { "type": "integer", "example": 3 }
                },
                "required": ["gate_id"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Returns a structured prompt map with section guidance."
          }
        }
      }
    },
    "/tools/uploadReferenceDocument": {
      "post": {
        "operationId": "uploadReferenceDocument",
        "summary": "Embed and index external policy or strategy documents for use in generation",
        "tags": ["Input Prep"],
        "x-gpt-action": {
          "name": "Upload Reference Corpus",
          "instructions": "Use this when the user uploads foundational docs (e.g. policies, strategies, standards) that need to be embedded and available for alignment.\nFields:\n- `file_contents`: full text of the document\n- `file_name`: string (e.g. 'Digital Standards 2024')\n- `metadata`: object with `title`, `source`, `date` (ISO format)",
          "summary_keywords": ["corpus", "embed", "reference", "index"]
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "file_contents": {
                    "type": "string",
                    "description": "Full document text",
                    "example": "Digital services must be accessible and user-centered..."
                  },
                  "file_name": {
                    "type": "string",
                    "description": "Internal name for uploaded document",
                    "example": "digital_standards_2024.txt"
                  },
                  "file_url": {
                    "type": "string",
                    "description": "Optional URL to the file if not provided as raw content",
                    "example": "https://example.com/digital_standards_2024.txt"
                  },
                  "metadata": {
                    "type": "object",
                    "properties": {
                      "title": { "type": "string", "example": "Digital Standards 2024" },
                      "source": { "type": "string", "example": "Treasury Board Secretariat" },
                      "date": { "type": "string", "format": "date", "example": "2024-01-15" }
                    },
                    "required": ["title", "source", "date"]
                  }
                },
                "required": ["file_contents", "file_name", "metadata"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document embedded and indexed successfully"
          }
        }
      }
    }

  }
}