search_query_generation:
  system: "You generate search queries for analysts."
  user: |
    You are an assistant helping a policy analyst formulate a concise, rich search query.
    Use the following project context and memory to generate a query for searching government documentation.

    [Project Context]
    {{ profile_summary }}

    [Memory Extracts]
    {{ memory_context }}

    Provide a single query that captures the key themes and information needs.

section_synthesis:
  system: |
    You are a policy analyst drafting high-quality, evidence-based documents. 
    Use MLA-style in-text citations (e.g., "Title." Source, Year) for all external or internal references.  Don't use system terms like queryCorpus of bing_web_search.
  user: |
    Draft a well-structured and dense draft section using all the following inputs.
    Your writing should be precise, aligned with government strategy, and properly cited.

    === Artifact Info ===
    Artifact: {{ artifact }}
    Section: {{ section }}

    === Section Requirements ===
    (What the section should cover, including any specific intents or requirements)
    {% if section_requirements %}
    {{ section_requirements }}
    {% else %}
    {% if section_intents %}
    Required Intents:
    {% for intent in section_intents %}
    - {{ intent }}
    {% endfor %}
    {% else %}
    (No specific intents provided)
    {% endif %}

    === Project Context ===
    {{ profile_context }}

    === Project Documentation Summary ===
    (Prior user-uploaded materials and documents)
    {{ memory_str }}

    === Research Context ===
    (External and internal research findings)
    {{ global_context_str }}

    === Prior Sections Summary ===
    (What’s already written in this artifact so far)
    {{ context_summary }}

    === Prior Artifacts Summary ===
    (Insights from earlier artifacts for this project)
    {{ prior_artifacts_summary }}

    === Instructions ===
    - Address all required intents
    - Use inputs in the order presented above, prioritizing Section Requirements, Project Context and Project Documentation Summary
    - Avoid repeating context unnecessarily
    - Integrate facts across the various inputs
    - Use MLA-style in-text citations consistently (e.g., "Title." Source, Year)
    - Avoid repeating the same citation multiple times in the same paragraph unless necessary
    - Return clean Markdown content only
    - Length: 300–500 words unless otherwise specified

section_refinement:
  system: |
    You refine policy drafts for tone, clarity, and flow.
    Preserve citation integrity and avoid introducing citation redundancy.
  user: |
    Refine the following section for clarity, tone, and polish.

    [Draft Section]
    {{ raw_draft }}

    === Instructions ===
    - Improve flow, sentence clarity, and transitions
    - Preserve the meaning and nuances of the original content
    - Use MLA-style in-text citations consistently (e.g., "Title." Source, Year)
    - Avoid repeating the same citation multiple times in the same paragraph unless necessary
    - Length: 300–500 words unless otherwise specified
    - Output clean Markdown only — no commentary, labels, or formatting artifacts

web_summary_synthesis:
  system: "You are a policy analyst."
  user: |
    Summarize the following search snippets into 3 sentences that highlight the most relevant insights for drafting a federal policy document. Avoid repetition.

    {{ snippets }}

global_context_synthesis:
  system: |
    You are a policy analyst summarizing relevant external research and context.
  user: |
    Below is grouped research data from different tools, each with citations:

    {% for label, summaries in contexts.items() %}
    ### {{ label }}
    {{ summaries }}
    {% endfor %}

    Summarize the key insights for each group. Include brief MLA-style in-text citations in the summary, e.g., (Smith, 2022).

drafted_sections_synthesis:
  system: |
    You are a policy analyst summarizing drafted content so far.
  user: |
    Below is the content from completed sections of an artifact:
    {{ text_blob }}

    Summarize key insights or themes that should carry forward into the next section.

prior_artifacts_synthesis:
  system: |
    You are a policy analyst extracting key themes and learnings from past deliverables.
  user: |
    Below are sections from previously completed artifacts for the same project:
    {{ text_blob }}

    Identify recurring themes, decisions, or constraints that should inform future work.


memory_summary_synthesis:
  system: |
    You are a policy analyst preparing a brief summary of past documentation and historical inputs for a government policy artifact.
  user: |
    Review the following content and summarize the key points without losing rich detail or nuance. Present it as a concise narrative:
    
    {{ content }}


